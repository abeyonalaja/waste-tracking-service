meta {
  name: Auth Token - Valid Credentials
  type: http
  seq: 1
}

post {
  url: {{authBaseUrl}}/oauth2/token
  body: formUrlEncoded
  auth: none
}

headers {
  Content-Type: application/x-www-form-urlencoded
  Authorization: Basic {{base64Credentials}}
}

body:form-urlencoded {
  grant_type: client_credentials
}

vars:post-response {
  ManuallyObtainedAccessToken: res.body.access_token
}

script:pre-request {
  let credentials = `${bru.getEnvVar("clientId")}:${bru.getEnvVar("clientSecret")}`
  bru.setVar('base64Credentials', Buffer.from(credentials).toString('base64'));
}

settings {
  encodeUrl: true
}
